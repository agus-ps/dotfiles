%YAML 1.1
---
# ======================================================
# SURICATA LAB CONFIG - optimizado para Wazuh + web HTTP/HTTPS
# ======================================================

runmode: workers
host-mode: sniffer-only

# --- Captura de tráfico ---
af-packet:
  - interface: ens5       # Cambiá por tu interfaz real (ip a)
    threads: auto
    cluster-id: 99
    cluster-type: cluster_flow
    defrag: yes
    use-mmap: yes

# Desactivamos los demás modos de captura
nflog:
  enabled: no
nfq:
  enabled: no
pcap:
  enabled: no
pfring:
  enabled: no
netmap:
  enabled: no
napatech:
  enabled: no

# --- Variables de red ---
vars:
  address-groups:
    HOME_NET: "[172.31.0.0/20]"     # Cambiá según tu red interna
    EXTERNAL_NET: "!$HOME_NET"

# --- Reglas ---
default-rule-path: /etc/suricata/rules
rule-files:
  - emerging-scan.rules
  - emerging-ftp.rules
  - emerging-ssh.rules
  - emerging-telnet.rules
  - emerging-dos.rules
  - emerging-web_server.rules
  - emerging-web_specific_apps.rules
  - emerging-sql.rules

# --- Flujo y capa de aplicación ---
flow:
  memcap: 64mb
  hash-size: 65536

app-layer:
  protocols:
    http:
      enabled: yes
    tls:
      enabled: yes
    ssh:
      enabled: yes
    ftp:
      enabled: yes
    dns:
      enabled: no
    smtp:
      enabled: no
    imap:
      enabled: no
    smb:
      enabled: no
    dnp3:
      enabled: no
    modbus:
      enabled: no

# --- Logging ---
logging:
  default-log-level: info
  outputs:
    - file:
        enabled: yes
        filename: /var/log/suricata/suricata.log

# --- Outputs principales ---
outputs:
  - eve-log:
      enabled: yes
      filetype: regular
      filename: /var/log/suricata/eve.json
      community-id: yes
      types:
        - alert:
            payload: no
            metadata: yes
        - stats:
            enabled: no
  - fast:
      enabled: yes
      filename: /var/log/suricata/fast.log

# --- Otros outputs deshabilitados ---
  - http-log:
      enabled: no
  - dns-log:
      enabled: no
  - tls-log:
      enabled: no
  - files-json:
      enabled: no
  - drop:
      enabled: no
  - stats:
      enabled: no
  - flow:
      enabled: no

# --- Diversos ---
engine-analysis:
  enabled: no
profiling:
  rules:
    enabled: no
coredump:
  max-dump: unlimited

# --- EOF ---
